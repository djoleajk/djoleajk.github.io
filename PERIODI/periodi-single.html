<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Periodi - Pra캖enje Menstrualnog Ciklusa</title>
    <meta name="description" content="Jednostavna aplikacija za pra캖enje menstrualnog ciklusa sa svim potrebnim funkcijama">
    <meta name="keywords" content="menstrualni ciklus, pra캖enje, kalendar, simptomi, period">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E游뽖%3C/text%3E%3C/svg%3E">
    <link rel="manifest" href="data:application/json,{%22name%22:%22Periodi%20-%20Pra%C4%87enje%20Menstrualnog%20Ciklusa%22,%22short_name%22:%22Periodi%22,%22description%22:%22Jednostavna%20aplikacija%20za%20pra%C4%87enje%20menstrualnog%20ciklusa%22,%22start_url%22:%22/%22,%22display%22:%22standalone%22,%22background_color%22:%22#fafafa%22,%22theme_color%22:%22#e91e63%22,%22orientation%22:%22portrait-primary%22,%22categories%22:[%22health%22,%22productivity%22],%22lang%22:%22sr-RS%22,%22icons%22:[{%22src%22:%22data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3E%3Ccircle%20cx='256'%20cy='256'%20r='256'%20fill='%23e91e63'/%3E%3Ctext%20x='256'%20y='320'%20font-family='Arial,%20sans-serif'%20font-size='300'%20font-weight='bold'%20text-anchor='middle'%20fill='white'%3E游뽖%3C/text%3E%3C/svg%3E%22,%22sizes%22:%22512x512%22,%22type%22:%22image/svg+xml%22,%22purpose%22:%22any%20maskable%22}]}">
    <style>
/* Import Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap');

/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    /* Light Theme */
    --primary-color: #e91e63;
    --primary-dark: #c2185b;
    --primary-gradient: linear-gradient(135deg, #e91e63 0%, #ff4081 100%);
    --secondary-color: #f48fb1;
    --secondary-gradient: linear-gradient(135deg, #f48fb1 0%, #f06292 100%);
    --accent-color: #ff4081;
    --success-color: #4caf50;
    --success-gradient: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
    --warning-color: #ff9800;
    --warning-gradient: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%);
    --error-color: #f44336;
    --error-gradient: linear-gradient(135deg, #f44336 0%, #ef5350 100%);
    --info-color: #2196f3;
    --info-gradient: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);

    --text-primary: #1a1a1a;
    --text-secondary: #666666;
    --text-muted: #999999;
    --bg-primary: #fefefe;
    --bg-secondary: #ffffff;
    --bg-tertiary: #f8f9fa;
    --bg-gradient: linear-gradient(135deg, #fefefe 0%, #f8f9fa 100%);
    --border-color: #e9ecef;
    --border-light: #f1f3f4;

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
    --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.16);
    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.2);

    --glow-primary: 0 0 20px rgba(233, 30, 99, 0.3);
    --glow-success: 0 0 20px rgba(76, 175, 80, 0.3);
    --glow-warning: 0 0 20px rgba(255, 152, 0, 0.3);
    --glow-error: 0 0 20px rgba(244, 67, 54, 0.3);

    --border-radius: 12px;
    --border-radius-lg: 16px;
    --border-radius-xl: 20px;

    --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);

    --glass-bg: rgba(255, 255, 255, 0.25);
    --glass-border: rgba(255, 255, 255, 0.18);
    --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
}

/* Dark Theme */
[data-theme="dark"] {
    --primary-color: #ff6b9d;
    --primary-dark: #ff4081;
    --primary-gradient: linear-gradient(135deg, #ff6b9d 0%, #ff4081 100%);
    --secondary-color: #ffb3c1;
    --secondary-gradient: linear-gradient(135deg, #ffb3c1 0%, #ff8a9d 100%);
    --accent-color: #ff4081;
    --success-color: #81c784;
    --success-gradient: linear-gradient(135deg, #81c784 0%, #a5d6a7 100%);
    --warning-color: #ffb74d;
    --warning-gradient: linear-gradient(135deg, #ffb74d 0%, #ffcc80 100%);
    --error-color: #ef5350;
    --error-gradient: linear-gradient(135deg, #ef5350 0%, #e57373 100%);
    --info-color: #64b5f6;
    --info-gradient: linear-gradient(135deg, #64b5f6 0%, #90caf9 100%);

    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --text-muted: #888888;
    --bg-primary: #1a1a1a;
    --bg-secondary: #2d2d2d;
    --bg-tertiary: #404040;
    --bg-gradient: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    --border-color: #404040;
    --border-light: #555555;

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
    --shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.5);
    --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.6);
    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.7);

    --glow-primary: 0 0 20px rgba(255, 107, 157, 0.4);
    --glow-success: 0 0 20px rgba(129, 199, 132, 0.4);
    --glow-warning: 0 0 20px rgba(255, 183, 77, 0.4);
    --glow-error: 0 0 20px rgba(239, 83, 80, 0.4);

    --glass-bg: rgba(45, 45, 45, 0.25);
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.6);
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    line-height: 1.6;
    color: var(--text-primary);
    background: var(--bg-gradient);
    font-size: clamp(14px, 2.5vw, 16px);
    font-weight: 400;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    transition: var(--transition);
}

/* Smooth scrolling */
html {
    scroll-behavior: smooth;
}

.app-container {
    max-width: 1200px;
    margin: 0 auto;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header */
.app-header {
    background: var(--bg-secondary);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-color);
    padding: 1rem 1.5rem;
    position: sticky;
    top: 0;
    z-index: 100;
    transition: var(--transition);
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.logo-section {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.logo-gradient {
    width: 48px;
    height: 48px;
    border-radius: var(--border-radius);
    background: var(--primary-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    box-shadow: var(--shadow-md);
    transition: var(--transition-bounce);
}

.logo-gradient:hover {
    transform: scale(1.05);
    box-shadow: var(--glow-primary);
}

.app-header h1 {
    color: var(--text-primary);
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    font-weight: 700;
    font-family: 'Poppins', sans-serif;
    margin: 0;
    letter-spacing: -0.02em;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.theme-toggle {
    width: 48px;
    height: 48px;
    border: none;
    border-radius: var(--border-radius);
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.theme-toggle:hover {
    background: var(--primary-color);
    color: white;
    transform: scale(1.05);
}

.theme-toggle .fa-sun {
    position: absolute;
    opacity: 1;
    transform: rotate(0deg);
    transition: var(--transition);
}

.theme-toggle .fa-moon {
    position: absolute;
    opacity: 0;
    transform: rotate(180deg);
    transition: var(--transition);
}

[data-theme="dark"] .theme-toggle .fa-sun {
    opacity: 0;
    transform: rotate(-180deg);
}

[data-theme="dark"] .theme-toggle .fa-moon {
    opacity: 1;
    transform: rotate(0deg);
}

.nav-tabs {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.nav-tabs::-webkit-scrollbar {
    display: none;
}

.nav-tab {
    background: none;
    border: none;
    padding: 1rem 1.5rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition-fast);
    white-space: nowrap;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
    color: var(--text-secondary);
    position: relative;
    min-width: 80px;
    font-weight: 500;
}

.nav-tab:hover {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
    transform: translateY(-2px);
}

.nav-tab.active {
    background: var(--primary-gradient);
    color: white;
    box-shadow: var(--glow-primary);
}

.nav-tab.active .nav-indicator {
    opacity: 1;
    transform: scaleX(1);
}

.nav-indicator {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%) scaleX(0);
    width: 60%;
    height: 3px;
    background: white;
    border-radius: 2px;
    opacity: 0;
    transition: var(--transition);
}

/* Main Content */
.main-content {
    flex: 1;
    padding: 1rem;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

/* Dashboard */
.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.5rem;
}

.dashboard-card {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-lg);
    padding: 2rem;
    box-shadow: var(--shadow);
    transition: var(--transition);
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
}

.dashboard-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--primary-gradient);
    border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
}

.dashboard-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary-color);
}

.dashboard-card.cycle-status::before {
    background: var(--primary-gradient);
}

.dashboard-card.prediction::before {
    background: var(--success-gradient);
}

.dashboard-card.stats::before {
    background: var(--info-gradient);
}

.dashboard-card.actions::before {
    background: var(--warning-gradient);
}

.dashboard-card h3 {
    color: var(--text-primary);
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
}

.cycle-info {
    margin-bottom: 1rem;
}

.cycle-phase {
    font-size: 1.1rem;
    font-weight: 500;
    color: var(--primary-color);
    margin-bottom: 0.25rem;
}

.cycle-days {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.prediction-date {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.days-count {
    font-size: 0.9rem;
    color: var(--text-secondary);
    background-color: var(--bg-tertiary);
    padding: 0.25rem 0.5rem;
    border-radius: var(--border-radius);
    display: inline-block;
}

.stats-grid {
    display: grid;
    gap: 0.75rem;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border-color);
}

.stat-item:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.stat-value {
    font-weight: 600;
    color: var(--primary-color);
}

.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

/* Cycle Progress */
.cycle-progress {
    margin: 1.5rem 0;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: var(--bg-tertiary);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 0.75rem;
    position: relative;
}

.progress-fill {
    height: 100%;
    background: var(--primary-gradient);
    border-radius: 4px;
    transition: var(--transition);
    position: relative;
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.progress-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Buttons */
.btn {
    padding: 0.875rem 1.75rem;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    transition: var(--transition-fast);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
    justify-content: center;
    position: relative;
    overflow: hidden;
    font-family: 'Inter', sans-serif;
    letter-spacing: 0.025em;
    box-shadow: var(--shadow-sm);
}

.btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transition: var(--transition);
    transform: translate(-50%, -50%);
}

.btn:hover::before {
    width: 300px;
    height: 300px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: var(--primary-gradient);
    color: white;
    box-shadow: var(--glow-primary);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--glow-primary), var(--shadow-md);
}

.btn-secondary {
    background: var(--secondary-gradient);
    color: white;
}

.btn-secondary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.btn-outline {
    background-color: transparent;
    border: 2px solid var(--border-color);
    color: var(--text-primary);
}

.btn-outline:hover {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--glow-primary);
}

.btn-danger {
    background: var(--error-gradient);
    color: white;
    box-shadow: var(--glow-error);
}

.btn-danger:hover {
    transform: translateY(-2px);
    box-shadow: var(--glow-error), var(--shadow-md);
}

.btn-success {
    background: var(--success-gradient);
    color: white;
    box-shadow: var(--glow-success);
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: var(--glow-success), var(--shadow-md);
}

/* Loading state */
.btn.loading {
    pointer-events: none;
    position: relative;
}

.btn.loading::after {
    content: '';
    width: 16px;
    height: 16px;
    border: 2px solid transparent;
    border-top: 2px solid currentColor;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-left: 0.5rem;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Floating Action Button */
.fab {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--primary-gradient);
    border: none;
    color: white;
    cursor: pointer;
    box-shadow: var(--shadow-xl), var(--glow-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    transition: var(--transition-bounce);
    z-index: 50;
}

.fab:hover {
    transform: scale(1.1) rotate(180deg);
    box-shadow: var(--shadow-xl), var(--glow-primary), 0 0 40px rgba(233, 30, 99, 0.4);
}

.fab:active {
    transform: scale(0.95);
}

/* Calendar */
.calendar-container {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-lg);
    padding: 2rem;
    box-shadow: var(--shadow);
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
}

.calendar-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--info-gradient);
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.calendar-header h2 {
    font-size: 1.6rem;
    color: var(--text-primary);
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
}

.calendar-grid {
    margin-bottom: 2rem;
}

.weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.weekdays div {
    text-align: center;
    font-weight: 600;
    color: var(--text-secondary);
    padding: 0.75rem;
    font-size: 0.85rem;
    background: var(--bg-tertiary);
    border-radius: var(--border-radius);
    font-family: 'Inter', sans-serif;
}

.days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem;
}

.day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition-fast);
    position: relative;
    font-size: 0.9rem;
    font-weight: 500;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}

.day:hover {
    transform: scale(1.1);
    box-shadow: var(--shadow-md);
    z-index: 10;
}

.day.today {
    background: var(--primary-gradient);
    color: white;
    font-weight: 700;
    box-shadow: var(--glow-primary);
    animation: pulse 2s infinite;
}

.day.period {
    background: var(--error-gradient);
    color: white;
    box-shadow: var(--glow-error);
}

.day.period.today {
    background: var(--error-gradient);
    color: white;
    box-shadow: var(--glow-error);
}

.day.ovulation {
    background: var(--success-gradient);
    color: white;
    box-shadow: var(--glow-success);
}

.day.fertile {
    background: var(--warning-gradient);
    color: white;
    box-shadow: var(--glow-warning);
}

.day.other-month {
    opacity: 0.4;
    pointer-events: none;
}

@keyframes pulse {
    0% { box-shadow: var(--glow-primary); }
    50% { box-shadow: var(--glow-primary), 0 0 20px rgba(233, 30, 99, 0.6); }
    100% { box-shadow: var(--glow-primary); }
}

.calendar-legend {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: 50%;
}

.legend-color.period {
    background-color: var(--error-color);
}

.legend-color.ovulation {
    background-color: var(--success-color);
}

.legend-color.fertile {
    background-color: var(--warning-color);
}

/* Symptoms */
.symptoms-container h2 {
    margin-bottom: 1.5rem;
    color: var(--text-primary);
}

.symptoms-form {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: var(--shadow);
}

.symptoms-form h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-group label {
    font-weight: 500;
    color: var(--text-primary);
}

.form-input, .form-range {
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
}

.form-input:focus, .form-range:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(233, 30, 99, 0.1);
}

.form-range {
    cursor: pointer;
}

.symptoms-checklist {
    margin-bottom: 1.5rem;
}

.symptoms-checklist h4 {
    margin-bottom: 0.75rem;
    color: var(--text-primary);
}

.checkbox-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 0.75rem;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--border-radius);
    transition: var(--transition);
}

.checkbox-label:hover {
    background-color: var(--bg-tertiary);
}

.checkbox-label input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--primary-color);
}

.symptoms-history {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    box-shadow: var(--shadow);
}

.symptoms-history h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

.symptoms-list {
    display: grid;
    gap: 1rem;
}

.symptom-entry {
    background: var(--bg-tertiary);
    padding: 1rem;
    border-radius: var(--border-radius);
    border-left: 4px solid var(--primary-color);
}

.symptom-date {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.symptom-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 0.5rem;
    font-size: 0.9rem;
}

/* Settings */
.settings-container h2 {
    margin-bottom: 1.5rem;
    color: var(--text-primary);
}

.settings-section {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow);
}

.settings-section h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

.checkbox-settings {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.data-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

/* Modals */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: 1000;
    animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: var(--bg-secondary);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--shadow-xl);
    border: 1px solid var(--border-color);
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    animation: slideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
}

.modal-content::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--primary-gradient);
    border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
}

.modal-header h3 {
    color: var(--text-primary);
    margin: 0;
}

.close-modal {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-secondary);
    padding: 0.25rem;
    border-radius: var(--border-radius);
    transition: var(--transition);
}

.close-modal:hover {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
    padding: 1.5rem;
    border-top: 1px solid var(--border-color);
}

/* Quick Actions Modal */
.quick-actions-content {
    max-width: 400px;
}

.quick-actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
}

.quick-action-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    padding: 1.5rem 1rem;
    background: var(--bg-tertiary);
    border: 2px solid var(--border-color);
    border-radius: var(--border-radius-lg);
    cursor: pointer;
    transition: var(--transition-fast);
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-primary);
}

.quick-action-btn:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
    border-color: var(--primary-color);
    background: var(--primary-color);
    color: white;
}

.quick-action-btn i {
    font-size: 1.5rem;
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    .calendar-header {
        flex-direction: column;
        gap: 1rem;
    }
    .form-grid {
        grid-template-columns: 1fr;
    }
    .checkbox-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    .modal-content {
        margin: 1rem;
        width: calc(100% - 2rem);
    }
    .modal-footer {
        flex-direction: column;
    }
    .data-actions {
        flex-direction: column;
    }
    .action-buttons {
        flex-direction: column;
    }
}

@media (max-width: 480px) {
    .nav-tab span {
        display: none;
    }
    .main-content {
        padding: 0.5rem;
    }
    .dashboard-card {
        padding: 1rem;
    }
    .calendar-container {
        padding: 1rem;
    }
    .symptoms-form, .symptoms-history {
        padding: 1rem;
    }
    .settings-section {
        padding: 1rem;
    }
    .checkbox-grid {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-gradient">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h1>Periodi</h1>
                </div>
                <div class="header-actions">
                    <button id="theme-toggle" class="theme-toggle" title="Promeni temu">
                        <i class="fas fa-sun"></i>
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                    <div class="nav-indicator"></div>
                </button>
                <button class="nav-tab" data-tab="calendar">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Kalendar</span>
                    <div class="nav-indicator"></div>
                </button>
                <button class="nav-tab" data-tab="symptoms">
                    <i class="fas fa-chart-line"></i>
                    <span>Simptomi</span>
                    <div class="nav-indicator"></div>
                </button>
                <button class="nav-tab" data-tab="settings">
                    <i class="fas fa-cog"></i>
                    <span>Pode코avanja</span>
                    <div class="nav-indicator"></div>
                </button>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="dashboard-grid">
                    <!-- Current Cycle Status -->
                    <div class="dashboard-card cycle-status">
                        <h3><i class="fas fa-clock"></i> Trenutni Ciklus</h3>
                        <div id="cycle-status" class="cycle-info">
                            <div class="cycle-phase">Nema aktivnog ciklusa</div>
                            <div class="cycle-days">Dan 0</div>
                        </div>
                        <div id="cycle-progress" class="cycle-progress" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            <div class="progress-labels">
                                <span>Menstruacija</span>
                                <span>Ovulacija</span>
                                <span>Kraj ciklusa</span>
                            </div>
                        </div>
                        <button id="start-cycle-btn" class="btn btn-primary">
                            <i class="fas fa-play"></i> Po캜ni Ciklus
                        </button>
                    </div>

                    <!-- Next Period Prediction -->
                    <div class="dashboard-card prediction">
                        <h3><i class="fas fa-calendar-check"></i> Slede캖a Menstruacija</h3>
                        <div id="next-period" class="prediction-date">
                            Nije izra캜unato
                        </div>
                        <div id="days-until" class="days-count">-</div>
                    </div>

                    <!-- Cycle Statistics -->
                    <div class="dashboard-card stats">
                        <h3><i class="fas fa-chart-bar"></i> Statistika</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Prose캜na du쬴na ciklusa</span>
                                <span id="avg-cycle-length" class="stat-value">28 dana</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Prose캜na du쬴na menstruacije</span>
                                <span id="avg-period-length" class="stat-value">5 dana</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Ukupno ciklusa</span>
                                <span id="total-cycles" class="stat-value">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="dashboard-card actions">
                        <h3><i class="fas fa-bolt"></i> Brze Akcije</h3>
                        <div class="action-buttons">
                            <button id="log-period-btn" class="btn btn-secondary">
                                <i class="fas fa-tint"></i> Zabele쬴 Menstruaciju
                            </button>
                            <button id="log-symptoms-btn" class="btn btn-secondary">
                                <i class="fas fa-notes-medical"></i> Zabele쬴 Simptome
                            </button>
                            <button id="add-reminder-btn" class="btn btn-secondary">
                                <i class="fas fa-bell"></i> Dodaj Podsetnik
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar Tab -->
            <div id="calendar-tab" class="tab-content">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button id="prev-month" class="btn btn-outline"><i class="fas fa-chevron-left"></i></button>
                        <h2 id="current-month-year">Decembar 2024</h2>
                        <button id="next-month" class="btn btn-outline"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="calendar-grid">
                        <div class="weekdays">
                            <div>Pon</div>
                            <div>Uto</div>
                            <div>Sre</div>
                            <div>캛et</div>
                            <div>Pet</div>
                            <div>Sub</div>
                            <div>Ned</div>
                        </div>
                        <div id="calendar-days" class="days-grid">
                            <!-- Calendar days will be generated by JavaScript -->
                        </div>
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item">
                            <div class="legend-color period"></div>
                            <span>Menstruacija</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color ovulation"></div>
                            <span>Ovulacija</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color fertile"></div>
                            <span>P켹odni dani</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Symptoms Tab -->
            <div id="symptoms-tab" class="tab-content">
                <div class="symptoms-container">
                    <h2><i class="fas fa-chart-line"></i> Pra캖enje Simptoma</h2>

                    <!-- Symptoms Form -->
                    <div class="symptoms-form">
                        <h3>Zabele쬴 dana코nje simptome</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Datum:</label>
                                <input type="date" id="symptom-date" class="form-input">
                            </div>

                            <div class="form-group">
                                <label>Energija (1-10):</label>
                                <input type="range" id="energy-level" min="1" max="10" value="5" class="form-range">
                                <span id="energy-value">5</span>
                            </div>

                            <div class="form-group">
                                <label>Raspolo쬰nje (1-10):</label>
                                <input type="range" id="mood-level" min="1" max="10" value="5" class="form-range">
                                <span id="mood-value">5</span>
                            </div>

                            <div class="form-group">
                                <label>Bol (1-10):</label>
                                <input type="range" id="pain-level" min="1" max="10" value="1" class="form-range">
                                <span id="pain-value">1</span>
                            </div>

                            <div class="form-group">
                                <label>Libido (1-10):</label>
                                <input type="range" id="libido-level" min="1" max="10" value="5" class="form-range">
                                <span id="libido-value">5</span>
                            </div>
                        </div>

                        <div class="symptoms-checklist">
                            <h4>Dodatni simptomi:</h4>
                            <div class="checkbox-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-cramps"> Gr캜evi
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-headache"> Glavobolja
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-nausea"> Mu캜nina
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-bloating"> Nadutost
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-breast-tenderness"> Osetljivost grudi
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="symptom-acne"> Akne
                                </label>
                            </div>
                        </div>

                        <button id="save-symptoms-btn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Sa캜uvaj Simptome
                        </button>
                    </div>

                    <!-- Symptoms History -->
                    <div class="symptoms-history">
                        <h3>Istorija Simptoma</h3>
                        <div id="symptoms-list" class="symptoms-list">
                            <!-- Symptoms will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-container">
                    <h2><i class="fas fa-cog"></i> Pode코avanja</h2>

                    <div class="settings-section">
                        <h3>Ciklus Pode코avanja</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Prose캜na du쬴na ciklusa (dana):</label>
                                <input type="number" id="cycle-length" min="21" max="35" value="28" class="form-input">
                            </div>
                            <div class="form-group">
                                <label>Prose캜na du쬴na menstruacije (dana):</label>
                                <input type="number" id="period-length" min="3" max="7" value="5" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Notifikacije</h3>
                        <div class="checkbox-settings">
                            <label class="checkbox-label">
                                <input type="checkbox" id="notify-period-start" checked>
                                Podseti me za po캜etak menstruacije
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="notify-ovulation" checked>
                                Podseti me za ovulaciju
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="notify-fertile-window">
                                Podseti me za plodne dane
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Podaci</h3>
                        <div class="data-actions">
                            <button id="export-data-btn" class="btn btn-secondary">
                                <i class="fas fa-download"></i> Izvezi Podatke
                            </button>
                            <button id="clear-data-btn" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Obri코i Sve Podatke
                            </button>
                        </div>
                    </div>

                    <button id="save-settings-btn" class="btn btn-primary">
                        <i class="fas fa-save"></i> Sa캜uvaj Pode코avanja
                    </button>
                </div>
            </div>
        </main>

        <!-- Floating Action Button -->
        <button id="fab" class="fab">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Modals -->
        <div id="cycle-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Po캜ni Novi Ciklus</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Datum po캜etka menstruacije:</label>
                        <input type="date" id="cycle-start-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Procenjena du쬴na ciklusa (dana):</label>
                        <input type="number" id="cycle-duration" min="21" max="35" value="28" class="form-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-cycle-btn" class="btn btn-primary">Sa캜uvaj</button>
                    <button class="btn btn-secondary close-modal">Otka쬴</button>
                </div>
            </div>
        </div>

        <div id="reminder-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Dodaj Podsetnik</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Naslov podsetnika:</label>
                        <input type="text" id="reminder-title" placeholder="npr. Uzmi lekove" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Vreme:</label>
                        <input type="datetime-local" id="reminder-time" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Ponavljaj:</label>
                        <select id="reminder-repeat" class="form-input">
                            <option value="once">Jednom</option>
                            <option value="daily">Svakodnevno</option>
                            <option value="weekly">Nedeljno</option>
                            <option value="monthly">Mese캜no</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-reminder-btn" class="btn btn-primary">Sa캜uvaj</button>
                    <button class="btn btn-secondary close-modal">Otka쬴</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Periodi - Menstrual Cycle Tracking App
        class PeriodTracker {
            constructor() {
                this.currentDate = new Date();
                this.cycles = [];
                this.symptoms = [];
                this.settings = {
                    cycleLength: 28,
                    periodLength: 5,
                    notifications: {
                        periodStart: true,
                        ovulation: true,
                        fertileWindow: false
                    }
                };
                this.reminders = [];

                this.init();
            }

            init() {
                this.loadData();
                this.setupEventListeners();
                this.updateDashboard();
                this.renderCalendar();
                this.updateSymptomsDisplay();
                this.loadSettings();
                this.initTheme();

                // Set default date for symptom input
                document.getElementById('symptom-date').valueAsDate = new Date();

                // Schedule cycle notifications
                this.scheduleCycleNotifications();
            }

            // Local Storage Management
            loadData() {
                const cycles = localStorage.getItem('periodi_cycles');
                const symptoms = localStorage.getItem('periodi_symptoms');
                const settings = localStorage.getItem('periodi_settings');
                const reminders = localStorage.getItem('periodi_reminders');

                if (cycles) this.cycles = JSON.parse(cycles);
                if (symptoms) this.symptoms = JSON.parse(symptoms);
                if (settings) this.settings = { ...this.settings, ...JSON.parse(settings) };
                if (reminders) this.reminders = JSON.parse(reminders);
            }

            saveData() {
                localStorage.setItem('periodi_cycles', JSON.stringify(this.cycles));
                localStorage.setItem('periodi_symptoms', JSON.stringify(this.symptoms));
                localStorage.setItem('periodi_settings', JSON.stringify(this.settings));
                localStorage.setItem('periodi_reminders', JSON.stringify(this.reminders));
            }

            // Event Listeners
            setupEventListeners() {
                // Tab Navigation
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', () => this.switchTab(tab.dataset.tab));
                });

                // Dashboard Actions
                document.getElementById('start-cycle-btn').addEventListener('click', () => this.showCycleModal());
                document.getElementById('log-period-btn').addEventListener('click', () => this.showCycleModal());
                document.getElementById('log-symptoms-btn').addEventListener('click', () => this.switchTab('symptoms'));
                document.getElementById('add-reminder-btn').addEventListener('click', () => this.showReminderModal());

                // Calendar Navigation
                document.getElementById('prev-month').addEventListener('click', () => this.changeMonth(-1));
                document.getElementById('next-month').addEventListener('click', () => this.changeMonth(1));

                // Modals
                document.querySelectorAll('.close-modal').forEach(btn => {
                    btn.addEventListener('click', () => this.closeModal());
                });

                // Cycle Modal
                document.getElementById('save-cycle-btn').addEventListener('click', () => this.saveCycle());

                // Symptoms
                document.getElementById('save-symptoms-btn').addEventListener('click', () => this.saveSymptoms());
                document.querySelectorAll('.form-range').forEach(range => {
                    range.addEventListener('input', (e) => this.updateRangeValue(e.target));
                });

                // Settings
                document.getElementById('save-settings-btn').addEventListener('click', () => this.saveSettings());
                document.getElementById('export-data-btn').addEventListener('click', () => this.exportData());
                document.getElementById('clear-data-btn').addEventListener('click', () => this.clearAllData());

                // Reminder Modal
                document.getElementById('save-reminder-btn').addEventListener('click', () => this.saveReminder());

                // FAB
                document.getElementById('fab').addEventListener('click', () => this.showQuickActions());
            }

            // Tab Management
            switchTab(tabName) {
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.add('active');
            }

            // Dashboard
            updateDashboard() {
                this.updateCycleStatus();
                this.updatePredictions();
                this.updateStatistics();
            }

            updateCycleStatus() {
                const statusEl = document.getElementById('cycle-status');
                const progressEl = document.getElementById('cycle-progress');
                const progressFill = document.getElementById('progress-fill');
                const activeCycle = this.getActiveCycle();

                if (activeCycle) {
                    const startDate = new Date(activeCycle.startDate);
                    const today = new Date();
                    const daysDiff = Math.floor((today - startDate) / (1000 * 60 * 60 * 24)) + 1;
                    const phase = this.getCyclePhase(daysDiff);
                    const progressPercent = Math.min((daysDiff / activeCycle.length) * 100, 100);

                    statusEl.innerHTML = `
                        <div class="cycle-phase">${phase}</div>
                        <div class="cycle-days">Dan ${daysDiff} od ${activeCycle.length}</div>
                    `;

                    progressEl.style.display = 'block';
                    progressFill.style.width = `${progressPercent}%`;

                    // Color progress bar based on phase
                    if (daysDiff <= activeCycle.periodLength) {
                        progressFill.style.background = 'var(--error-gradient)';
                    } else if (daysDiff >= 14 && daysDiff <= 16) {
                        progressFill.style.background = 'var(--success-gradient)';
                    } else {
                        progressFill.style.background = 'var(--primary-gradient)';
                    }
                } else {
                    statusEl.innerHTML = `
                        <div class="cycle-phase">Nema aktivnog ciklusa</div>
                        <div class="cycle-days">Dan 0</div>
                    `;
                    progressEl.style.display = 'none';
                }
            }

            updatePredictions() {
                const nextPeriodEl = document.getElementById('next-period');
                const daysUntilEl = document.getElementById('days-until');

                const nextPeriod = this.predictNextPeriod();
                if (nextPeriod) {
                    const daysUntil = Math.ceil((nextPeriod - new Date()) / (1000 * 60 * 60 * 24));

                    nextPeriodEl.textContent = nextPeriod.toLocaleDateString('sr-RS');

                    if (daysUntil > 0) {
                        daysUntilEl.textContent = `${daysUntil} dana`;
                        daysUntilEl.className = 'days-count';
                    } else if (daysUntil === 0) {
                        daysUntilEl.textContent = 'Danas!';
                        daysUntilEl.className = 'days-count today';
                    } else {
                        daysUntilEl.textContent = 'Pro코lo';
                        daysUntilEl.className = 'days-count past';
                    }
                } else {
                    nextPeriodEl.textContent = 'Nije izra캜unato';
                    daysUntilEl.textContent = '-';
                }
            }

            updateStatistics() {
                const avgCycleEl = document.getElementById('avg-cycle-length');
                const avgPeriodEl = document.getElementById('avg-period-length');
                const totalCyclesEl = document.getElementById('total-cycles');

                if (this.cycles.length > 0) {
                    const avgCycle = this.cycles.reduce((sum, cycle) => sum + cycle.length, 0) / this.cycles.length;
                    const avgPeriod = this.cycles.reduce((sum, cycle) => sum + cycle.periodLength, 0) / this.cycles.length;

                    this.animateCounter(avgCycleEl, Math.round(avgCycle), ' dana');
                    this.animateCounter(avgPeriodEl, Math.round(avgPeriod), ' dana');
                    this.animateCounter(totalCyclesEl, this.cycles.length, '');
                }
            }

            animateCounter(element, target, suffix = '') {
                const current = parseInt(element.textContent) || 0;
                const increment = target > current ? 1 : -1;
                const timer = setInterval(() => {
                    element.textContent = current + suffix;
                    if (current === target) {
                        clearInterval(timer);
                    }
                    current += increment;
                }, 50);
            }

            // Cycle Management
            getActiveCycle() {
                return this.cycles.find(cycle => !cycle.endDate);
            }

            getCyclePhase(day) {
                const cycleLength = this.settings.cycleLength;
                const periodLength = this.settings.periodLength;

                if (day <= periodLength) return 'Menstruacija';
                if (day >= 14 && day <= 16) return 'Ovulacija';
                if (day >= 10 && day <= 18) return 'Plodni period';
                if (day > periodLength && day < cycleLength - 7) return 'Folikularna faza';
                return 'Lutealna faza';
            }

            predictNextPeriod() {
                if (this.cycles.length === 0) return null;

                const lastCycle = this.cycles[this.cycles.length - 1];
                if (!lastCycle.endDate) return null;

                const lastEndDate = new Date(lastCycle.endDate);
                const avgCycleLength = this.cycles.reduce((sum, cycle) => sum + cycle.length, 0) / this.cycles.length;

                return new Date(lastEndDate.getTime() + avgCycleLength * 24 * 60 * 60 * 1000);
            }

            showCycleModal() {
                const modal = document.getElementById('cycle-modal');
                const today = new Date().toISOString().split('T')[0];

                document.getElementById('cycle-start-date').value = today;
                document.getElementById('cycle-duration').value = this.settings.cycleLength;

                modal.classList.add('show');
            }

                    saveCycle() {
                        const startDate = document.getElementById('cycle-start-date').value;
                        const duration = parseInt(document.getElementById('cycle-duration').value);

                        if (!startDate) {
                            alert('Molimo izaberite datum po캜etka ciklusa.');
                            return;
                        }

                        const newCycle = {
                            id: Date.now(),
                            startDate: startDate,
                            length: duration,
                            periodLength: this.settings.periodLength,
                            endDate: null
                        };

                        this.cycles.push(newCycle);
                        this.saveData();
                        this.updateDashboard();
                        this.renderCalendar();
                        this.updateCycleNotifications();
                        this.closeModal();
                    }

            // Calendar
            renderCalendar() {
                const calendarDays = document.getElementById('calendar-days');
                const monthYear = document.getElementById('current-month-year');

                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();

                monthYear.textContent = `${this.getMonthName(month)} ${year}`;

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay() + 1);

                calendarDays.innerHTML = '';

                for (let i = 0; i < 42; i++) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'day';
                    dayEl.textContent = startDate.getDate();

                    // Mark current month
                    if (startDate.getMonth() === month) {
                        dayEl.classList.add('current-month');
                    } else {
                        dayEl.classList.add('other-month');
                    }

                    // Mark today
                    if (this.isToday(startDate)) {
                        dayEl.classList.add('today');
                    }

                    // Mark period days
                    if (this.isPeriodDay(startDate)) {
                        dayEl.classList.add('period');
                    }

                    // Mark ovulation day
                    if (this.isOvulationDay(startDate)) {
                        dayEl.classList.add('ovulation');
                    }

                    // Mark fertile days
                    if (this.isFertileDay(startDate)) {
                        dayEl.classList.add('fertile');
                    }

                    calendarDays.appendChild(dayEl);
                    startDate.setDate(startDate.getDate() + 1);
                }
            }

            changeMonth(delta) {
                this.currentDate.setMonth(this.currentDate.getMonth() + delta);
                this.renderCalendar();
            }

            getMonthName(month) {
                const months = ['Januar', 'Februar', 'Mart', 'April', 'Maj', 'Jun',
                               'Jul', 'Avgust', 'Septembar', 'Oktobar', 'Novembar', 'Decembar'];
                return months[month];
            }

            isToday(date) {
                const today = new Date();
                return date.toDateString() === today.toDateString();
            }

            isPeriodDay(date) {
                return this.cycles.some(cycle => {
                    const startDate = new Date(cycle.startDate);
                    const endDate = new Date(startDate);
                    endDate.setDate(startDate.getDate() + cycle.periodLength - 1);

                    return date >= startDate && date <= endDate;
                });
            }

            isOvulationDay(date) {
                return this.cycles.some(cycle => {
                    const startDate = new Date(cycle.startDate);
                    const ovulationDate = new Date(startDate);
                    ovulationDate.setDate(startDate.getDate() + 14); // Assuming ovulation on day 14

                    return date.toDateString() === ovulationDate.toDateString();
                });
            }

            isFertileDay(date) {
                return this.cycles.some(cycle => {
                    const startDate = new Date(cycle.startDate);
                    const fertileStart = new Date(startDate);
                    fertileStart.setDate(startDate.getDate() + 10); // Fertile window starts ~10 days after period
                    const fertileEnd = new Date(startDate);
                    fertileEnd.setDate(startDate.getDate() + 16); // Fertile window ends ~16 days after period

                    return date >= fertileStart && date <= fertileEnd;
                });
            }

            // Symptoms
            updateRangeValue(range) {
                const valueEl = document.getElementById(range.id.replace('-level', '-value'));
                valueEl.textContent = range.value;
            }

            saveSymptoms() {
                const date = document.getElementById('symptom-date').value;
                const energy = document.getElementById('energy-level').value;
                const mood = document.getElementById('mood-level').value;
                const pain = document.getElementById('pain-level').value;
                const libido = document.getElementById('libido-level').value;

                const additionalSymptoms = [];
                document.querySelectorAll('.symptoms-checklist input:checked').forEach(checkbox => {
                    additionalSymptoms.push(checkbox.id.replace('symptom-', ''));
                });

                if (!date) {
                    alert('Molimo izaberite datum.');
                    return;
                }

                const symptomEntry = {
                    id: Date.now(),
                    date: date,
                    energy: parseInt(energy),
                    mood: parseInt(mood),
                    pain: parseInt(pain),
                    libido: parseInt(libido),
                    additional: additionalSymptoms
                };

                // Remove existing entry for this date
                this.symptoms = this.symptoms.filter(s => s.date !== date);
                this.symptoms.push(symptomEntry);

                this.saveData();
                this.updateSymptomsDisplay();

                // Reset form
                document.getElementById('symptom-date').valueAsDate = new Date();
                document.querySelectorAll('.form-range').forEach(range => {
                    range.value = 5;
                    this.updateRangeValue(range);
                });
                document.querySelectorAll('.symptoms-checklist input').forEach(checkbox => {
                    checkbox.checked = false;
                });

                alert('Simptomi su sa캜uvani!');
            }

            updateSymptomsDisplay() {
                const symptomsList = document.getElementById('symptoms-list');
                symptomsList.innerHTML = '';

                if (this.symptoms.length === 0) {
                    symptomsList.innerHTML = '<p>Nema zabele쬰nih simptoma.</p>';
                    return;
                }

                this.symptoms.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(symptom => {
                    const entryEl = document.createElement('div');
                    entryEl.className = 'symptom-entry';

                    const date = new Date(symptom.date).toLocaleDateString('sr-RS');
                    const additionalText = symptom.additional.length > 0 ?
                        `<br>Dodatni simptomi: ${symptom.additional.join(', ')}` : '';

                    entryEl.innerHTML = `
                        <div class="symptom-date">${date}</div>
                        <div class="symptom-details">
                            <div>Energija: ${symptom.energy}/10</div>
                            <div>Raspolo쬰nje: ${symptom.mood}/10</div>
                            <div>Bol: ${symptom.pain}/10</div>
                            <div>Libido: ${symptom.libido}/10</div>
                            ${additionalText ? `<div>${additionalText}</div>` : ''}
                        </div>
                    `;

                    symptomsList.appendChild(entryEl);
                });
            }

            // Settings
            loadSettings() {
                document.getElementById('cycle-length').value = this.settings.cycleLength;
                document.getElementById('period-length').value = this.settings.periodLength;
                document.getElementById('notify-period-start').checked = this.settings.notifications.periodStart;
                document.getElementById('notify-ovulation').checked = this.settings.notifications.ovulation;
                document.getElementById('notify-fertile-window').checked = this.settings.notifications.fertileWindow;
            }

                    saveSettings() {
                        this.settings.cycleLength = parseInt(document.getElementById('cycle-length').value);
                        this.settings.periodLength = parseInt(document.getElementById('period-length').value);
                        this.settings.notifications.periodStart = document.getElementById('notify-period-start').checked;
                        this.settings.notifications.ovulation = document.getElementById('notify-ovulation').checked;
                        this.settings.notifications.fertileWindow = document.getElementById('notify-fertile-window').checked;

                        this.saveData();
                        this.updateDashboard();
                        this.renderCalendar();
                        this.updateCycleNotifications();

                        alert('Pode코avanja su sa캜uvana!');
                    }

            exportData() {
                const data = {
                    cycles: this.cycles,
                    symptoms: this.symptoms,
                    settings: this.settings,
                    exportDate: new Date().toISOString()
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = `periodi-export-${new Date().toISOString().split('T')[0]}.json`;
                a.click();

                URL.revokeObjectURL(url);
            }

            clearAllData() {
                if (confirm('Da li ste sigurni da 쬰lite obrisati sve podatke? Ova akcija se ne mo쬰 poni코titi.')) {
                    this.cycles = [];
                    this.symptoms = [];
                    this.reminders = [];
                    this.saveData();
                    this.updateDashboard();
                    this.renderCalendar();
                    this.updateSymptomsDisplay();
                    alert('Svi podaci su obrisani.');
                }
            }

            // Reminders
            showReminderModal() {
                const modal = document.getElementById('reminder-modal');
                modal.classList.add('show');
            }

            saveReminder() {
                const title = document.getElementById('reminder-title').value;
                const time = document.getElementById('reminder-time').value;
                const repeat = document.getElementById('reminder-repeat').value;

                if (!title || !time) {
                    alert('Molimo popunite naslov i vreme podsetnika.');
                    return;
                }

                const reminder = {
                    id: Date.now(),
                    title: title,
                    time: time,
                    repeat: repeat,
                    active: true
                };

                this.reminders.push(reminder);
                this.saveData();

                // Schedule notification if supported
                if ('Notification' in window && Notification.permission === 'granted') {
                    this.scheduleNotification(reminder);
                }

                this.closeModal();

                // Reset form
                document.getElementById('reminder-title').value = '';
                document.getElementById('reminder-time').value = '';
                document.getElementById('reminder-repeat').value = 'once';

                alert('Podsetnik je sa캜uvan!');
            }

            scheduleNotification(reminder) {
                const reminderTime = new Date(reminder.time);
                const now = new Date();

                if (reminderTime > now) {
                    setTimeout(() => {
                        new Notification('Periodi - Podsetnik', {
                            body: reminder.title,
                            icon: '/favicon.ico'
                        });
                    }, reminderTime - now);
                }
            }

            // Theme Management
            initTheme() {
                const savedTheme = localStorage.getItem('periodi_theme') || 'light';
                this.setTheme(savedTheme);

                document.getElementById('theme-toggle').addEventListener('click', () => {
                    const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                    this.setTheme(newTheme);
                });
            }

            setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('periodi_theme', theme);

                // Update theme toggle button
                const toggleBtn = document.getElementById('theme-toggle');
                if (theme === 'dark') {
                    toggleBtn.title = 'Prebaci na svetlu temu';
                } else {
                    toggleBtn.title = 'Prebaci na tamnu temu';
                }
            }

            // Quick Actions
            showQuickActions() {
                const activeCycle = this.getActiveCycle();
                let actions = [];

                if (!activeCycle) {
                    actions = [
                        { icon: 'fa-play', text: 'Po캜ni ciklus', action: () => this.showCycleModal() },
                        { icon: 'fa-notes-medical', text: 'Zabele쬴 simptome', action: () => this.switchTab('symptoms') }
                    ];
                } else {
                    actions = [
                        { icon: 'fa-tint', text: 'Zabele쬴 menstruaciju', action: () => this.showCycleModal() },
                        { icon: 'fa-notes-medical', text: 'Zabele쬴 simptome', action: () => this.switchTab('symptoms') },
                        { icon: 'fa-bell', text: 'Dodaj podsetnik', action: () => this.showReminderModal() }
                    ];
                }

                this.showQuickActionsModal(actions);
            }

            showQuickActionsModal(actions) {
                const modalHTML = `
                    <div id="quick-actions-modal" class="modal">
                        <div class="modal-content quick-actions-content">
                            <div class="modal-header">
                                <h3>Brze akcije</h3>
                                <button class="close-modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="quick-actions-grid">
                                    ${actions.map(action => `
                                        <button class="quick-action-btn" data-action="${action.icon}">
                                            <i class="fas ${action.icon}"></i>
                                            <span>${action.text}</span>
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                document.body.insertAdjacentHTML('beforeend', modalHTML);

                // Add event listeners
                document.querySelectorAll('.quick-action-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const actionIcon = btn.dataset.action;
                        const action = actions.find(a => a.icon === actionIcon);
                        if (action) action.action();
                        this.closeModal();
                        // Remove modal from DOM
                        document.getElementById('quick-actions-modal').remove();
                    });
                });

                document.querySelector('#quick-actions-modal .close-modal').addEventListener('click', () => {
                    this.closeModal();
                    document.getElementById('quick-actions-modal').remove();
                });

                // Show modal
                setTimeout(() => {
                    document.getElementById('quick-actions-modal').classList.add('show');
                }, 10);
            }

            // Cycle Notifications
            scheduleCycleNotifications() {
                if (!('Notification' in window) || Notification.permission !== 'granted') {
                    return;
                }

                // Clear existing cycle notifications
                if (this.cycleNotificationTimeouts) {
                    this.cycleNotificationTimeouts.forEach(timeout => clearTimeout(timeout));
                }
                this.cycleNotificationTimeouts = [];

                const activeCycle = this.getActiveCycle();
                if (!activeCycle) return;

                const now = new Date();
                const startDate = new Date(activeCycle.startDate);

                // Schedule period start notification (if enabled)
                if (this.settings.notifications.periodStart) {
                    const nextPeriodDate = this.predictNextPeriod();
                    if (nextPeriodDate && nextPeriodDate > now) {
                        const timeUntil = nextPeriodDate - now;
                        const timeout = setTimeout(() => {
                            new Notification('Periodi - Po캜etak Menstruacije', {
                                body: 'Va코a slede캖a menstruacija po캜inje danas. Vodite ra캜una o sebi!',
                                icon: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"%3E%3Ctext y=".9em" font-size="90"%3E游뽖%3C/text%3E%3C/svg%3E'
                            });
                        }, timeUntil);
                        this.cycleNotificationTimeouts.push(timeout);
                    }
                }

                // Schedule ovulation notification (if enabled)
                if (this.settings.notifications.ovulation) {
                    const ovulationDate = new Date(startDate);
                    ovulationDate.setDate(startDate.getDate() + 14); // Day 14 is typically ovulation

                    if (ovulationDate > now) {
                        const timeUntil = ovulationDate - now;
                        const timeout = setTimeout(() => {
                            new Notification('Periodi - Ovulacija', {
                                body: 'Danas je va코 dan ovulacije. Plodni period je aktivan!',
                                icon: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"%3E%3Ctext y=".9em" font-size="90"%3E游꺚%3C/text%3E%3C/svg%3E'
                            });
                        }, timeUntil);
                        this.cycleNotificationTimeouts.push(timeout);
                    }
                }

                // Schedule fertile window notification (if enabled)
                if (this.settings.notifications.fertileWindow) {
                    const fertileStartDate = new Date(startDate);
                    fertileStartDate.setDate(startDate.getDate() + 10); // Fertile window starts around day 10

                    if (fertileStartDate > now) {
                        const timeUntil = fertileStartDate - now;
                        const timeout = setTimeout(() => {
                            new Notification('Periodi - Plodni Period', {
                                body: 'Po캜inje va코 plodni period. Pratite svoje simptome!',
                                icon: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"%3E%3Ctext y=".9em" font-size="90"%3E游꺜%3C/text%3E%3C/svg%3E'
                            });
                        }, timeUntil);
                        this.cycleNotificationTimeouts.push(timeout);
                    }
                }
            }

            // Update cycle notifications when settings change
            updateCycleNotifications() {
                this.scheduleCycleNotifications();
            }

            // Modal Management
            closeModal() {
                document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('show'));
            }
        }

        // Request notification permission on load
        if ('Notification' in window) {
            Notification.requestPermission();
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            new PeriodTracker();
        });
    </script>
</body>
</html>
